---
title: 常用Linux命令
categories:
  - Linux
tags:
  - Linux
date: 2018-09-08 08:17:44
---

对于程序员来讲，学习一些常用Linux命令还是很有必要，<!-- more -->毕竟有些时候我们需要登录到Linux服务器上查看下程序的运行状态，或者做一些其他的操作。本篇文章主要是介绍常用的Linux命令，并不涉及多么专业的知识。

## 帮助命令

Linux命令很多，我们不可能每个都会，都记得怎么使用，如果拿到一个命令，怎么快速的学习怎么使用呢？这里主要有3种方法：

第一种方法是通过命令本身的帮助选项，几乎所有的Linux命令后面跟上```--help```选项，都可以查看命令的使用说明，例如我们想查看```ls```如何使用，就可以使用```ls --help```。

第二方法是使用```man```指令，例如 ```man ls```。

第三种方法是使用```info```指令，例如```info ls```。

## 文件与目录管理

说起目录我们就要先讲一下相对路径和绝对路径，相对路径是以当前目录为起点到达另一个目录的路径，而绝对路径是以根目录为起点到达另一个目录的路径。

这里我们要介绍几个比较特殊的目录：

- ```.```  当前目录
- ```..```  上级目录
- ```~```  当前用户的家目录
- ```/```  系统根目录

### 显示当前目录 pwd

- ```pwd``` 显示当前目录的绝对路径


### 切换目录命令 cd

- ```cd ../tmp/```  使用相对路径切换目录
- ```cd /tmp```  使用绝对路径切换目录  
- ```cd ~```  切换到家目录  
- ```cd -```  切换到上次访问过的目录 

### 新建目录 mkdir

- ```mkdir /demo``` 新建demo目录
- ```mkdir -p /demo/demo1``` 在/demo下新建demo1目录，-p的作用是当上级目录不存在时，同时新建上级目录
- ```mkdir -m 777 /demo```  新建目录时同时指定权限

### 删除目录 rmdir

- ```rmdir /demo```  删除demo目录
- ```rmdir /demo/demo1```  删除demo1目录

### 查看文件命令 ls

- ```ls``` 查看当前目录下有哪些文件
- ```ls /tmp```  查看指定目录的文件，这里可以使用相对路径也可以使用绝对路径
- ```ls -l```  显示文件的详细信息，包括权限、所有者、所属群组、文件大小、最后修改日期等，这个命令也经常缩写成```ll```
- ```ls -a```  显示目录下所有文件，包括隐藏文件
- ```ls -al``` 上面两条命令的组合

### 修改文件权限 chmod

可以通过我们上面讲过的命令```ll```查看文件的权限，结果如下所示

```
drwxrwxr-x  2 superuser superuser  4096 Sep  8 09:56 demo1/
-rw-rw-r--  1 superuser superuser     0 Sep  8 09:56 demo2.md
lrwxrwxrwx  1 superuser superuser     8 Sep  8 09:57 demo3.md -> demo2.md
```

结果中第一列就是就是文件的类型与权限，我们可以看到第一列一共有10个字符，其中第一个字符表示文件的类型，[d]表示目录，[-]表示文件，[l]表示链接文件，当然这三种是常见的文件类型，还有其他类型我们就不介绍了。

第一列后面的九个字符可以分为三组，每组的三个字符分别代表[r]可读，[w]可写，[x]可执行，如果缺少相应的权限，则相应的位置上就会是[-]。另外这三组权限分别代表文件所有者的权限、文件所属群组的权限、其他人的权限。比如```-rw-rw-r--```表示这个文件所有者有读写权限，群组有读写权限，其他人只有读的权限。

另外不同的权限有着不同的分值，[r]4分，[w]2分，[x]1分，所以权限也可用分值的累加来表示，比如[rwx]的分值就是7，[rw-]的分值就是6。

有了这些基础知识后，我们就来看下如何修改文件的权限：

- ```chmod 777 demo2.md``` 将demo2.md的权限改为[rwxrwxrwx]

另外我们还可以通过符号类型来修改文件权限，在符号类型中[u]表示文件所有者，[g]表示文件所属群组，[o]表示其他人，[a]表示所有人[ugo]，[+]表示增加权限，[-]表示去掉权限，[=]表示赋予权限。

- ```chmod u=rwx,go=rx demo2.md```  表示所有者赋予rwx权限，群组和其他人赋予rx权限
- ```chmod a+x demo2.md```  表示给所有人增加x权限

### 复制 cp

- ```cp demo.md demo2.md```  复制文件
- ```cp -r ~/demo ~/demo2```  复制目录
- ```cp -a demo.md demo2.md```  完全复制，会把文件的所有属性一起复制过来

### 移动 mv

- ```mv ~/demo.md demo.md```  移动文件，常用来给文件重命名
- ```mv demo.md demo2.md```  文件重命名
- ```mv ~/demo demo```  移动目录

### 删除 rm

- ```rm demo.md```  删除文件
- ```rm -f demo.md```  强制删除文件
- ```rm -r ~/demo```  删除目录

### 新建文件 touch

- ```touch demo.md``` 如果demo.md不存在则新建文件，如果存在则更改文件的访问时间

### 文件链接 ln

文件链接分为软连接和硬链接，软连接相当于一个快捷方式，用来指向实际的文件名，如果原始文件删除了，则软连接的文件也就打不开了；而硬链接则是直接指向实际的文件内容，相当于同一个文件内容有两个或多个文件名指向它，删除了原始文件并不会把文件内容删除，而只是删除了文件名，所以还可以通过硬链接访问到。

另外，硬链接只能用于文件，而软连接不仅可以连接文件也可与连接目录。

- ```ln [-sf] 原始文件 连接文件```  使用方法
- ```ln demo demo-hard```  给demo设置个硬链接demo-hard
- ```ln -s demo demo-soft```  给demo设置个硬链接demo-soft
- ```ln -f demo demo-hard```  如果demo-hard存在，则删除后再创建

## 查阅文件内容

### 查看全部内容 cat

cat会把文件的内容打印到屏幕上，适合查看一些行数不多的文件。

- ```cat demo.md``` 查看文件内容
- ```cat -n demo.md``` 查看文件内容，并打印行号

### 翻页查看 more

与cat一次性展示所有内容不同，more会把文件的内容一页一页地展示出来。

- ``` more demo.md```  查看文件

在查看文件的过程中，可以使用如下按键：

- ```空格键```  向下翻一页
- ```回车键```  向下翻一行
- ```b```  回到文件开头
- ```/```  进入搜索模式，按下[/]后输入需要搜索的字符，再按下回车键，就可以向下搜索，按[n]表示搜索下一个
- ```q```  立即退出more指令，停止查看文件


### 翻页查看 less

less和more类似，都是按页查看文件，但是less命令更强大，因为less不仅可以可以往后翻页，还可以往前翻页；不仅可以向后搜索，还可以向前搜索。

另外由于less和more查看文件的时候不会把整个文件加载到内存，所以是查看大文件时的首选。

- ``` less demo.md```  查看文件

同样在查看文件的过程中，可以使用如下按键：

- ```空格键```  向下翻一页
- ```回车键```  向下翻一行
- ```b```  向上翻一页
- ```/```  向下搜索模式，按下[/]后输入需要搜索的字符，再按下回车键，就可以向下搜索
- ```？```  向上搜索模式
- ```n```  表示搜索下一个
- ```N```  表示搜索上一个
- ```g```  跳到第一行
- ```G```  跳到最后一行
- ```q```  立即退出more指令，停止查看文件

### 查看前几行 head

head命令用于提取文件的前n行内容。

- ``` head -n 5 demo.md```  查看前5行
- ``` head -5 demo.md```  查看前5行


### 查看后几行 tail

tail命令用于提取文件的后n行内容。

- ``` tail -n 5 demo.md```  查看后5行
- ``` tail -5 demo.md```  查看后5行


### 搜索文件内容 grep

grep命令用于查找文件里符合条件的字符串。

- ``` grep abc demo.md ``` 在文件中搜索字符串 abc
- ``` grep 'abc def' demo.md demo2.md``` 在多个文件中搜索
- ``` grep -c abc demo.md``` 搜索字符串出现的次数
- ``` grep -A 5 abc demo.md``` 搜索字符串出现行以及后面5行，A = after
- ``` grep -B 5 abc demo.md``` 搜索字符串出现行以及前面5行，B = before
- ``` grep -C 5 abc demo.md``` 搜索字符串出现行以及前后5行
- ``` grep -5 abc demo.md``` 搜索字符串出现行以及前后5行

## 搜索文件

### 搜索可执行文件 which

- ```which ls```  搜索ls指令，只展示第一条
- ```which -a ls```  搜索ls指令，展示所有结果

### 特定目录搜索 whereis

whereis只会搜索特定的目录，比如/bin/sbin、/usr/share/man。

- ```whereis -l```  显示whereis命令搜索的目录
- ```whereis ifconfig```  搜索所有含有ifconfig的文件

### 根据文件数据库搜索 locate

locate利用的是文件数据库搜索，相当于索引，所以速度很快，但是它有一个缺点是如果新增的文件还没有被收录到数据库中，就会搜索不到，数据库每天会自动更新一次，如果你想手动更新，可以使用```updatedb```命令，注意这个命令是一个耗时操作。

- ```locate pwd```  搜索文件名为pwd的文件
- ```locate -i pwd```  忽略大小写
- ```locate -r pwd*```  使用正则表达式搜索

### 全能搜索 find

find搜索功能强大，但是由于它搜索文件系统，比较耗时，所以使用时要特别注意。搜索时可以先使用whereis和locate，如果找不到再使用find；另外使用find时最好指定具体的搜索路径，而不要直接在根目录下搜索。

- ```find /demo -name demo.md```  在/demo目录下查找名称为demo.md的文件
- ```find /demo -name demo*```  通过正则表达式搜索
- ```find /demo -size +50k```  查找文件大小大于50k的文件
- ```find /demo -size -1M```  查找文件大小小于1M的文件

## 磁盘与目录容量

### 查看整体磁盘使用量 df

- ```df```  列出文件系统整体磁盘使用量
- ```df -h```  用人们较易阅读的格式显示

### 查看文件或目录容量 du

- ```du```  列出当前目录下所有文件大小，注意只会列出目录
- ```du -a```  列出当前目录下所有文件大小，包括文件
- ```du -s```  只列出当前目录总量
- ```du -h```  用人们较易阅读的格式显示
- ```du -sh /tmp``` 列出指定目录的大小
- ```du -h /tmp/demo.md``` 列出指定文件的大小

## 文件压缩与打包

### 文件压缩 gzip

gzip压缩文件后的后缀为```.gz```。

- ```gzip demo.md```  压缩文件，得到demo.md.gz，同时原文件demo.md也就不存在了
- ```gzip -k demo.md```  压缩文件，并且保留原文件
- ```gzip -d demo.md.gz```  解压缩文件

### 打包文件 tar

gzip只能压缩一个文件，如果我们要把一个文件夹压缩成一个文件就没办法了，这时就需要先用打包指令把文件夹打包成一个文件，然后在压缩。

- ```tar -cvf demo.tar demo```  将demo打包成demo.tar
- ```tar -zcvf demo.tar.gz demo```  将demo打包并压缩成demo.tar.gz
- ```tar -ztvf demo.tar.gz```  查看demo.tar.gz包含哪些内容
- ```tar -zxvf demo.tar.gz``` 解压缩
- ```tar -zxvf demo.tar.gz -C demo2``` 解压缩到指定目录


## 程序编辑器 vim

在Linux上编辑文本一般都是使用vim，由于vim强大的功能，它不仅仅可以作为普通的文本编辑器，甚至可以作为程序编辑器来使用。

vim使用时分为2种模式：一般指令模式和编辑模式。

### 一般指令模式

通常我们使用vim打开一个文件进入的就是一般指令模式，比如我们要打开一个文件demo.md，可以使用以下指令:```vim demo.md```。

一般指令模式下可以使用的指令很多，这里只介绍最常用的指令：

- ```Ctrl + f```  向下翻一页
- ```Ctrl + b```  向上翻一页
- ```0```  移到行首
- ```$```  移到行末
- ```G```  移到最后一行
- ```gg```  移到第一行
- ```/word<Enter>```  搜索关键字word，开始搜索后，按```n```表示继续搜索下一个，按```N```表示搜索上一个
- ```dd```  删除光标所在行
- ```ndd``` 删除光标向下n行，```dd```相当于```1dd```
- ```dG```  删除光标到最后一行的数据
- ```:w```  将修改写入硬盘，如果没有写权限会报错
- ```:w!```  强制将修改写入硬盘，不一定成功，和权限有关
- ```:q```  退出vim，不保存文件，如果修改过文件会报错
- ```:q!```  强制退出vim，不保存文件
- ```:wq``` 保存并离开
- ```:wq!``` 强制保存并离开

### 编辑模式

在一般指令模式向下，按```i```就进入了编辑模式，进入编辑模式还可以使用其他指令，但是我觉得记住一个```i```就够用了。

- ```<Esc>``` 退出编辑模式，回到一般指令模式

### 区块选择

一般来讲，我们选择文字都是按行来选中，如果想按列来选中文字怎么办呢？

- ```Ctrl + v``` 一般指令模式下，会进入区块选择，可以移动光标来选中内容
- ```y```  复制选择的区块
- ```p```  粘贴选择的区块
