---
title: MySQL之基本架构
categories:
  - MySQL
tags:
  - MySQL
date: 2019-04-27 13:30:28
---

本篇文章主要介绍 MySQL 内部有哪些组件，以及这些组件的主要作用。<!-- more -->

## 基本架构

大体来说，MySQL 可以分为 Server 层和存储引擎层两部分。

![](基本架构.png)

Server 层包括连接器、查询缓存、分析器、优化器、执行器等，涵盖 MySQL 的大多数核心服务功能，以及所有的内置函数（如日期、时间、数学和加密函数等），所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。

而存储引擎层负责数据的存储和提取。其架构模式是插件式的，支持 InnoDB、MyISAM、Memory 等多个存储引擎。现在最常用的存储引擎是 InnoDB，它从 MySQL 5.5.5 版本开始成为了默认存储引擎。

我们已经有一篇文章简单介绍了常见的存储引擎，所以本篇文章就不再介绍，而主要介绍 Server 层的组件。


### 连接器

连接器主要负责跟客户端建立连接、获取权限、维持和管理连接。


### 查询缓存

MySQL 拿到一个查询请求后，会先到查询缓存看看，如果存在缓存值则直接返回。否则继续执行，执行完成后，执行结果会被存入查询缓存中。

MySQL 拿到一个更新请求后，只要有对一个表的更新，这个表上所有的查询缓存都会被清空。

所以查询缓存的命中率非常低，开启查询缓存反而影响效率，因此大多说情况下都不建议使用查询缓存。除非查询一张静态表，或者更新频率非常低的表。


### 分析器

分析器主要做词法分析，就是分析 SQL 语句是否正确。


### 优化器

优化器是在表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序。


### 执行器

执行器负责执行 SQL 语句，开始执行的时候，要先判断一下你对这个表 T 有没有执行查询的权限，如果没有，就会返回没有权限的错误。如果有权限，就打开表继续执行。打开表的时候，执行器就会根据表的引擎定义，去使用这个引擎提供的接口。