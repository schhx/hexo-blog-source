---
title: Linux命令之top
categories:
  - Linux
tags:
  - Linux
date: 2019-06-08 09:18:05
---

top命令是Linux下最常用的性能分析工具，能够实时显示系统中各个进程的资源占用状况。<!-- more -->

### 使用方法

#### 命令格式

```
top [参数]
```

#### 参数列表

- ```-b```  批处理
- ```-c```  显示完整的命令
- ```-I```  忽略失效过程
- ```-s```  保密模式
- ```-S```  累积模式
- ```-i<时间>```  设置间隔时间
- ```-u<用户名>```  指定用户名
- ```-p<进程号>```  指定进程
- ```-n<次数>```  循环显示的次数



### 输出详解

当我们输入 ```top``` 命令后，输出类似如下所示，分为两大部分，上面是系统统计信息，下面是进程信息。

```
top - 09:29:32 up 57 days,  7:34,  1 user,  load average: 0.23, 0.28, 0.22
Tasks: 278 total,   1 running, 277 sleeping,   0 stopped,   0 zombie
%Cpu(s):  3.5 us,  2.1 sy,  0.0 ni, 94.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem : 16432700 total,   213268 free, 14595236 used,  1624196 buff/cache
KiB Swap:  8174588 total,  8041096 free,   133492 used.  1315252 avail Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 6857 root      20   0  342324  27456   1212 S   2.8  0.2   1601:34 python
19301 root      20   0 1250512  73780  15900 S   2.8  0.4   1925:59 kubelet
15829 root      20   0 2847012 248228  10884 S   1.4  1.5  68:53.46 java
17421 superus+  20   0   33724   3320   2772 R   1.4  0.0   0:00.02 top
17715 root      20   0 2850460 514688   8136 S   1.4  3.1 144:20.21 java
18285 root      20   0  951888  48840   5592 S   1.4  0.3  63:52.78 node
```

#### 系统统计信息

##### 第一行：任务队列信息

```
top - 09:29:32 up 57 days,  7:34,  1 user,  load average: 0.23, 0.28, 0.22
```
- ```09:29:32```  当前系统时间
- ```up 57 days,  7:34```  系统运行时间
- ```1 user```   当前登录用户数
- ```load average: 0.23, 0.28, 0.22```   系统的平均负载数，表示 1分钟、5分钟、15分钟到现在的平均数

##### 第二行：进程统计信息

```
Tasks: 278 total,   1 running, 277 sleeping,   0 stopped,   0 zombie
```

- ```278 total```  系统当前总进程总数
- ```1 running```  正在运行的进程数
- ```277 sleeping```  睡眠进程数
- ```0 stopped```  停止进程数
- ```0 zombie```  僵尸进程数

##### 第三行：CPU 统计信息

```
%Cpu(s):  3.5 us,  2.1 sy,  0.0 ni, 94.3 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
```

- ```3.5%us```  用户空间CPU占用率
- ```2.1%sy```  内核空间CPU占用率
- ```0.0%ni```  用户进程空间改变过优先级的进程CPU的占用率
- ```94.3%id```  空闲CPU占有率
- ```0.0%wa```  等待输入输出的CPU时间百分比
- ```0.0%hi```  硬件中断请求
- ```0.0%si```  软件中断请求
- ```0.0%st```  分配给运行在其它虚拟机上的任务的实际 CPU时间

##### 第四行：内存状态

```
KiB Mem : 16432700 total,   213268 free, 14595236 used,  1624196 buff/cache
```

- ```16432700 total```  物理内存总量
- ```213268 free```  空闲内存
- ```14595236 used```  已使用的内存
- ```1624196 buff/cache```  内核缓存使用


##### 第五行 swap交换分区信息

```
KiB Swap:  8174588 total,  8041096 free,   133492 used.  1315252 avail Mem
```
- ```8174588 total```  交换分区总量
- ```8041096 free```   空闲交换分区
- ```133492 used```  已使用交换分区内存
- ```1315252 avail Mem```  可用内存空间


#### 进程信息

```
  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 6857 root      20   0  342324  27456   1212 S   2.8  0.2   1601:34 python
```

- ```PID```  进程id
- ```USER```  进程所有者的用户名
- ```PR```  进程优先级
- ```NI```  nice值。负值表示高优先级，正值表示低优先级
- ```VIRT```  进程使用的虚拟内存总量，单位kb。VIRT=SWAP+RES
- ```RES```  进程使用的、未被换出的物理内存大小，单位kb。RES=CODE+DATA
- ```SHR```  共享内存大小，单位kb
- ```S```  进程状态。D=不可中断的睡眠状态 R=运行 S=睡眠 T=跟踪/停止 Z=僵尸进程
- ```%CPU```  上次更新到现在的CPU时间占用百分比
- ```%MEM```  进程使用的物理内存百分比
- ```TIME+```  进程使用的CPU时间总计，单位1/100秒
- ```COMMAND```  进程名称[命令名/命令行]



### 交互

- ```1``` 显示或折叠每个 CPU 核统计信息
- ```P``` 按%CPU使用率排行
- ```M``` 按%MEM排行
- ```T``` 按TIME+排行
- ```q``` 退出
